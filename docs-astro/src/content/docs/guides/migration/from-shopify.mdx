---
title: Migrating from Shopify
description: Complete step-by-step guide to migrating from Shopify/Shopify Plus to Next Commerce with code examples and best practices.
---

# Migrating from Shopify

This comprehensive guide walks you through migrating from Shopify or Shopify Plus to Next Commerce, covering everything from initial assessment to go-live optimization.

## Migration Overview

Shopify merchants can migrate to Next Commerce while preserving their existing store design, customer data, and analytics. Our HTML-first approach means most of your frontend code remains unchanged.

### Benefits of Migration

- **Reduced Platform Fees** - Eliminate Shopify transaction fees
- **Complete Ownership** - Host your own e-commerce solution
- **Advanced Customization** - No theme limitations
- **Better Performance** - Optimized loading and checkout
- **Enhanced Analytics** - Deeper customer insights

## Pre-Migration Assessment

### Current Shopify Setup Analysis

#### Store Configuration Audit
```javascript
// Document your current Shopify setup
const shopifyAudit = {
  theme: "Dawn (or custom theme name)",
  apps: [
    "Klaviyo Email Marketing",
    "Gorgias Customer Service",
    "Yotpo Reviews",
    "Searchspring Search"
  ],
  paymentGateways: ["Shopify Payments", "PayPal", "Apple Pay"],
  analytics: ["Google Analytics", "Facebook Pixel", "Klaviyo tracking"],
  customCode: ["custom.js modifications", "checkout.liquid changes"]
};
```

#### Product Catalog Assessment
```markdown
1. **Product Data**
   - Total products: ___
   - Product variants: ___
   - Collections: ___
   - Metafields: ___

2. **Media Assets**
   - Product images: ___
   - Product videos: ___
   - Collection images: ___
   - Other assets: ___

3. **Pricing Structure**
   - Regular pricing: ___
   - Sale pricing: ___
   - Customer-specific pricing: ___
   - Currency support: ___
```

## Shopify Data Export

### Product Data Extraction

#### Using Shopify Admin API
```javascript
// Export products via Shopify API
async function exportShopifyProducts() {
  const products = [];
  let pageInfo = null;
  
  do {
    const query = `
      query($first: Int!, $after: String) {
        products(first: $first, after: $after) {
          edges {
            node {
              id
              title
              description
              handle
              vendor
              productType
              tags
              variants(first: 100) {
                edges {
                  node {
                    id
                    title
                    sku
                    price
                    compareAtPrice
                    inventoryQuantity
                    weight
                    image {
                      url
                    }
                  }
                }
              }
              images(first: 10) {
                edges {
                  node {
                    url
                    altText
                  }
                }
              }
            }
          }
          pageInfo {
            hasNextPage
            endCursor
          }
        }
      }
    `;
    
    const response = await shopifyGraphQL(query, {
      first: 50,
      after: pageInfo
    });
    
    products.push(...response.data.products.edges);
    pageInfo = response.data.products.pageInfo.hasNextPage 
      ? response.data.products.pageInfo.endCursor 
      : null;
      
  } while (pageInfo);
  
  return products;
}
```

#### Product Data Mapping
```javascript
// Map Shopify products to Next Commerce packages
function mapShopifyToNextCommerce(shopifyProduct) {
  const product = shopifyProduct.node;
  
  return {
    // Basic product info
    name: product.title,
    description: product.description,
    sku: product.variants.edges[0]?.node.sku || product.handle,
    
    // Pricing
    price: parseFloat(product.variants.edges[0]?.node.price || 0),
    compareAtPrice: parseFloat(product.variants.edges[0]?.node.compareAtPrice || 0),
    
    // Images
    images: product.images.edges.map(img => ({
      url: img.node.url,
      alt: img.node.altText
    })),
    
    // Metadata
    vendor: product.vendor,
    productType: product.productType,
    tags: product.tags,
    
    // Variants (if applicable)
    variants: product.variants.edges.map(variant => ({
      id: variant.node.id,
      title: variant.node.title,
      sku: variant.node.sku,
      price: parseFloat(variant.node.price),
      inventory: variant.node.inventoryQuantity,
      weight: variant.node.weight
    }))
  };
}
```

### Customer Data Export

#### Customer Information
```javascript
// Export customer data for segmentation
async function exportShopifyCustomers() {
  const customers = await shopifyGraphQL(`
    query {
      customers(first: 250) {
        edges {
          node {
            id
            email
            firstName
            lastName
            phone
            createdAt
            updatedAt
            acceptsMarketing
            state
            totalSpent
            ordersCount
            tags
          }
        }
      }
    }
  `);
  
  return customers.data.customers.edges.map(customer => ({
    email: customer.node.email,
    firstName: customer.node.firstName,
    lastName: customer.node.lastName,
    phone: customer.node.phone,
    totalSpent: parseFloat(customer.node.totalSpent),
    orderCount: customer.node.ordersCount,
    acceptsMarketing: customer.node.acceptsMarketing,
    tags: customer.node.tags,
    createdAt: customer.node.createdAt
  }));
}
```

#### Order History Export
```javascript
// Export order data for analytics continuity
async function exportShopifyOrders() {
  const orders = await shopifyGraphQL(`
    query {
      orders(first: 250) {
        edges {
          node {
            id
            name
            email
            createdAt
            totalPrice
            subtotalPrice
            totalTax
            totalShippingPrice
            fulfillmentStatus
            financialStatus
            lineItems(first: 50) {
              edges {
                node {
                  title
                  quantity
                  variant {
                    sku
                    price
                  }
                }
              }
            }
          }
        }
      }
    }
  `);
  
  return orders.data.orders.edges.map(order => ({
    orderId: order.node.name,
    email: order.node.email,
    date: order.node.createdAt,
    total: parseFloat(order.node.totalPrice),
    subtotal: parseFloat(order.node.subtotalPrice),
    tax: parseFloat(order.node.totalTax),
    shipping: parseFloat(order.node.totalShippingPrice),
    status: order.node.fulfillmentStatus,
    items: order.node.lineItems.edges.map(item => ({
      name: item.node.title,
      quantity: item.node.quantity,
      sku: item.node.variant?.sku,
      price: parseFloat(item.node.variant?.price || 0)
    }))
  }));
}
```

## Next Commerce Setup

### Campaign Creation

#### Package Configuration
```javascript
// Create Next Commerce packages from Shopify data
function createNextCommercePackages(shopifyProducts) {
  return shopifyProducts.map((product, index) => {
    const mapped = mapShopifyToNextCommerce(product);
    
    return {
      ref_id: index + 1, // Sequential package IDs
      name: mapped.name,
      description: mapped.description,
      price: mapped.price,
      compare_at_price: mapped.compareAtPrice,
      image: mapped.images[0]?.url,
      sku: mapped.sku,
      
      // Additional metadata
      vendor: mapped.vendor,
      product_type: mapped.productType,
      tags: mapped.tags.join(','),
      
      // Shopify integration fields
      shopify_product_id: product.node.id,
      shopify_handle: product.node.handle
    };
  });
}
```

### Configuration Migration

#### Analytics Setup
```javascript
// Migrate Shopify analytics configuration
window.nextConfig = {
  apiKey: 'your-next-commerce-api-key',
  
  // Preserve existing analytics
  analytics: {
    enabled: true,
    mode: 'auto',
    providers: {
      // Migrate Google Analytics
      gtm: {
        enabled: true,
        settings: {
          containerId: "GTM-XXXXXXX", // Your existing GTM container
          dataLayerName: "dataLayer"
        }
      },
      
      // Migrate Facebook Pixel
      facebook: {
        enabled: true,
        settings: {
          pixelId: "1234567890123456" // Your existing Pixel ID
        }
      },
      
      // Klaviyo integration
      custom: {
        enabled: true,
        settings: {
          endpoint: "https://a.klaviyo.com/api/track",
          apiKey: "your-klaviyo-public-key"
        }
      }
    }
  },
  
  // Payment configuration
  paymentConfig: {
    expressCheckout: {
      requireValidation: true,
      requiredFields: ['email', 'fname', 'lname']
    }
  }
};
```

#### Discount Codes Migration
```javascript
// Migrate Shopify discount codes
window.nextConfig = {
  // ... other config
  discounts: {
    // Migrate existing discount codes
    WELCOME10: {
      code: "WELCOME10",
      type: "percentage",
      value: 10,
      scope: "order",
      description: "Welcome discount (migrated from Shopify)"
    },
    FREESHIP: {
      code: "FREESHIP",
      type: "shipping",
      value: 0,
      description: "Free shipping (migrated from Shopify)",
      minOrderAmount: 50
    }
  }
};
```

## Frontend Migration

### Theme Code Migration

#### Liquid to HTML Conversion

**Shopify Liquid (Before)**
```liquid
<!-- Shopify product display -->
<div class="product">
  <h1>{{ product.title }}</h1>
  <p class="price">${{ product.price | money_without_currency }}</p>
  <img src="{{ product.featured_image | img_url: '500x500' }}" alt="{{ product.title }}">
  
  <form action="/cart/add" method="post">
    <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
    <button type="submit">Add to Cart</button>
  </form>
</div>

<!-- Cart display -->
<div class="cart">
  <p>Items: {{ cart.item_count }}</p>
  <p>Total: ${{ cart.total_price | money_without_currency }}</p>
</div>
```

**Next Commerce HTML (After)**
```html
<!-- Next Commerce product display -->
<div class="product">
  <h1 data-next-display="packages[0].name">Product Name</h1>
  <p class="price" data-next-display="packages[0].price">$29.99</p>
  <img data-next-display="packages[0].image" alt="Product">
  
  <button data-next-action="add-to-cart" 
          data-next-package-id="1">
    Add to Cart
  </button>
</div>

<!-- Cart display -->
<div class="cart">
  <p>Items: <span data-next-display="cart.count">0</span></p>
  <p>Total: <span data-next-display="cart.total">$0.00</span></p>
</div>
```

#### Shopping Cart Migration

**Shopify Ajax Cart (Before)**
```javascript
// Shopify cart functions
function addToCart(variantId, quantity) {
  fetch('/cart/add.js', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      id: variantId,
      quantity: quantity
    })
  })
  .then(response => response.json())
  .then(data => updateCartDisplay());
}

function updateCartDisplay() {
  fetch('/cart.js')
    .then(response => response.json())
    .then(cart => {
      document.querySelector('.cart-count').textContent = cart.item_count;
      document.querySelector('.cart-total').textContent = `$${(cart.total_price / 100).toFixed(2)}`;
    });
}
```

**Next Commerce Implementation (After)**
```javascript
// Next Commerce automatically handles cart operations
window.nextReady.push(function() {
  // Cart updates are automatic, but you can listen for events
  next.on('cart:item-added', function(data) {
    console.log('Item added:', data);
    // Custom logic if needed
  });
  
  next.on('cart:updated', function(data) {
    console.log('Cart updated:', data);
    // Display updates are automatic
  });
});
```

### Checkout Process Migration

#### Shopify Checkout to Next Commerce

**Shopify Checkout Redirect (Before)**
```javascript
// Shopify checkout redirect
function proceedToCheckout() {
  window.location.href = '/checkout';
}
```

**Next Commerce Checkout (After)**
```html
<!-- Simple checkout trigger -->
<button data-next-action="checkout">
  Proceed to Checkout
</button>

<!-- Or with custom form validation -->
<button data-next-action="checkout" 
        data-next-require-form="checkout-form">
  Complete Order
</button>
```

### App Integration Migration

#### Klaviyo Integration
```javascript
// Migrate Klaviyo tracking from Shopify
window.nextReady.push(function() {
  // Map Next Commerce events to Klaviyo
  next.on('cart:item-added', function(data) {
    if (window._learnq) {
      _learnq.push(['track', 'Added to Cart', {
        '$event_id': `cart_${Date.now()}`,
        '$value': data.price,
        'ProductName': data.name,
        'ProductID': data.sku,
        'Categories': data.categories,
        'ImageURL': data.image,
        'URL': window.location.href,
        'Brand': data.vendor || 'Your Brand'
      }]);
    }
  });
  
  next.on('order:completed', function(data) {
    if (window._learnq) {
      _learnq.push(['track', 'Placed Order', {
        '$event_id': data.refId,
        '$value': data.total,
        'OrderId': data.refId,
        'Categories': data.items.map(item => item.category).join(','),
        'ItemNames': data.items.map(item => item.name),
        'Brands': data.items.map(item => item.vendor || 'Your Brand')
      }]);
    }
  });
});
```

#### Gorgias Integration
```javascript
// Migrate Gorgias customer service integration
window.nextReady.push(function() {
  next.on('order:completed', function(orderData) {
    // Update Gorgias with order information
    if (window.Gorgias) {
      Gorgias.identify(orderData.customer.email, {
        email: orderData.customer.email,
        name: orderData.customer.name,
        last_order_id: orderData.refId,
        last_order_total: orderData.total,
        total_spent: orderData.customer.totalSpent || orderData.total
      });
    }
  });
});
```

## SEO Migration

### URL Structure Preservation

#### Product URLs
```javascript
// Maintain Shopify URL structure for SEO
const urlMappings = {
  '/products/product-handle': '/product-page.html?product=1',
  '/collections/collection-handle': '/collection.html?collection=main',
  '/cart': '/cart.html',
  '/checkout': '/checkout.html'
};

// Implement redirects for SEO preservation
function handleShopifyUrls() {
  const currentPath = window.location.pathname;
  if (urlMappings[currentPath]) {
    // Redirect with 301 status for SEO
    window.location.replace(urlMappings[currentPath]);
  }
}
```

#### Structured Data Migration
```html
<!-- Migrate Shopify structured data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@type": "Product",
  "name": "{{product.name}}",
  "description": "{{product.description}}",
  "sku": "{{product.sku}}",
  "brand": {
    "@type": "Brand",
    "name": "Your Brand"
  },
  "offers": {
    "@type": "Offer",
    "url": "{{current_url}}",
    "priceCurrency": "USD",
    "price": "{{product.price}}",
    "availability": "https://schema.org/InStock"
  }
}
</script>
```

## Testing Strategy

### Functional Testing

#### Cart Operations Test
```javascript
// Test cart functionality during migration
window.nextReady.push(function() {
  const testSuite = {
    async testAddToCart() {
      console.log('Testing add to cart...');
      const initialCount = next.getCartData().count;
      
      // Simulate add to cart
      next.addToCart(1, 1);
      
      // Wait for update
      setTimeout(() => {
        const newCount = next.getCartData().count;
        console.assert(newCount === initialCount + 1, 'Add to cart failed');
        console.log('✅ Add to cart test passed');
      }, 500);
    },
    
    async testCheckout() {
      console.log('Testing checkout process...');
      // Test checkout flow
      next.checkout();
      // Verify checkout initiation
      console.log('✅ Checkout test initiated');
    }
  };
  
  // Run tests
  if (window.location.search.includes('test=true')) {
    Object.values(testSuite).forEach(test => test());
  }
});
```

### Performance Comparison

#### Load Time Monitoring
```javascript
// Compare performance with Shopify
const performanceMetrics = {
  shopifyBaseline: {
    pageLoad: 2400, // ms
    cartUpdate: 800,
    checkoutStart: 1200
  },
  
  nextCommerceTarget: {
    pageLoad: 1800, // 25% improvement target
    cartUpdate: 400,
    checkoutStart: 600
  }
};

window.nextReady.push(function() {
  const startTime = performance.now();
  
  next.on('cart:loaded', function() {
    const loadTime = performance.now() - startTime;
    console.log(`Next Commerce load time: ${loadTime}ms`);
    
    if (loadTime < performanceMetrics.nextCommerceTarget.pageLoad) {
      console.log('✅ Performance target met');
    } else {
      console.warn('⚠️ Performance target missed');
    }
  });
});
```

## Go-Live Strategy

### Phased Rollout

#### Traffic Splitting
```javascript
// Gradual migration with A/B testing
function initMigrationRollout() {
  const rolloutPercent = 25; // Start with 25% of traffic
  const userId = localStorage.getItem('user_id') || generateUserId();
  const userHash = hashCode(userId);
  const shouldUseMigration = (userHash % 100) < rolloutPercent;
  
  if (shouldUseMigration) {
    // Load Next Commerce
    loadNextCommerce();
    
    // Track migration users
    gtag('event', 'migration_user', {
      custom_parameter_1: 'next_commerce',
      custom_parameter_2: 'phase_1'
    });
  } else {
    // Keep using Shopify (temporarily)
    console.log('User in Shopify control group');
  }
}

// Gradually increase rollout percentage
window.addEventListener('load', initMigrationRollout);
```

### Monitoring Setup

#### Real-Time Monitoring
```javascript
// Monitor key metrics during migration
window.nextReady.push(function() {
  const monitoringConfig = {
    trackErrors: true,
    trackPerformance: true,
    trackConversions: true
  };
  
  // Error monitoring
  if (monitoringConfig.trackErrors) {
    next.on('error', function(error) {
      // Send to monitoring service
      fetch('/api/errors', {
        method: 'POST',
        body: JSON.stringify({
          error: error.message,
          stack: error.stack,
          url: window.location.href,
          timestamp: new Date().toISOString()
        })
      });
    });
  }
  
  // Conversion tracking
  if (monitoringConfig.trackConversions) {
    next.on('order:completed', function(data) {
      // Track migration success
      gtag('event', 'purchase', {
        transaction_id: data.refId,
        value: data.total,
        currency: 'USD',
        custom_parameter_1: 'next_commerce_migration'
      });
    });
  }
});
```

## Post-Migration Optimization

### Performance Optimization

#### Image Optimization
```javascript
// Optimize product images after migration
function optimizeProductImages() {
  // Use modern image formats
  const images = document.querySelectorAll('[data-next-display*="image"]');
  images.forEach(img => {
    const src = img.getAttribute('src');
    if (src && !src.includes('webp')) {
      // Convert to WebP for better performance
      img.setAttribute('src', src.replace(/\.(jpg|jpeg|png)/, '.webp'));
    }
  });
}

window.nextReady.push(optimizeProductImages);
```

#### Conversion Rate Optimization
```javascript
// Implement CRO improvements unique to Next Commerce
window.nextReady.push(function() {
  // Exit intent cart recovery
  next.exitIntent({
    image: '/images/exit-intent-offer.jpg',
    action: function() {
      // Apply discount for abandoned carts
      next.applyCoupon('SAVE10');
      alert('10% discount applied to your cart!');
    }
  });
  
  // Smart upsells
  next.on('cart:item-added', function(data) {
    // Suggest complementary products
    const upsells = getUpsellRecommendations(data.sku);
    if (upsells.length > 0) {
      showUpsellModal(upsells);
    }
  });
});
```

## Migration Checklist

### Pre-Migration
- [ ] Export all Shopify product data
- [ ] Export customer email lists
- [ ] Document current app integrations
- [ ] Backup current theme code
- [ ] Set up Next Commerce campaign
- [ ] Configure analytics tracking
- [ ] Test payment processing

### During Migration
- [ ] Implement progressive rollout
- [ ] Monitor error rates
- [ ] Track conversion rates
- [ ] Test all critical user flows
- [ ] Verify analytics data
- [ ] Check payment processing
- [ ] Monitor performance metrics

### Post-Migration
- [ ] Compare conversion rates
- [ ] Optimize performance
- [ ] Update SEO elements
- [ ] Train support team
- [ ] Update documentation
- [ ] Monitor customer feedback
- [ ] Plan feature enhancements

## Common Migration Issues

### Issue 1: Shopify App Dependencies

**Problem**: Existing Shopify apps won't work after migration
**Solution**: Implement equivalent functionality or find alternative integrations

```javascript
// Example: Replace Shopify review app
window.nextReady.push(function() {
  // Integrate with Yotpo or similar service
  next.on('order:completed', function(data) {
    // Trigger review request email
    sendReviewRequest(data.customer.email, data.refId);
  });
});
```

### Issue 2: Theme Styling Conflicts

**Problem**: Existing CSS doesn't work with Next Commerce
**Solution**: Create CSS namespace or gradual styling migration

```css
/* Isolate legacy styles */
.shopify-legacy {
  /* Original Shopify theme styles */
}

/* Next Commerce styles */
.next-commerce {
  /* New implementation styles */
}
```

### Issue 3: URL Structure Changes

**Problem**: SEO impact from URL changes
**Solution**: Implement proper redirects

```javascript
// SEO-friendly redirects
const redirectMap = {
  '/products/old-handle': '/new-product-page',
  '/collections/old-collection': '/new-collection-page'
};

// Implement 301 redirects for SEO
if (redirectMap[window.location.pathname]) {
  window.location.replace(redirectMap[window.location.pathname]);
}
```

## Getting Help

- **Migration Support**: Contact our migration specialists
- **Technical Documentation**: [Configuration Guide](../../configuration/)
- **Community**: Join our Discord for migration tips
- **Custom Development**: Available for complex migrations

## Related Documentation

- [General Migration Guide](./index/) - Platform-agnostic migration strategies
- [Performance Optimization](../optimization/performance/) - Post-migration optimization
- [Analytics Setup](../../javascript-api/analytics/) - Analytics configuration guide
- [Troubleshooting](../troubleshooting/) - Common issues and solutions
